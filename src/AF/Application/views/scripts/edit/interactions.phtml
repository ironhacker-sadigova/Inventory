<?php
use AF\Domain\AF;
use MyCLabs\MUIH\Collapse;

/** @var $af AF */
$af = $this->af;

$script = '';


$actionsSetState = new Collapse('actionsSetState', __('AF', 'configInteractionCollapse', 'componentStateModificationCollapse'));
$actionsSetState->setContent($this->partial('edit/actions/set-state.phtml', [
    'af'            => $af,
    'componentList' => $this->componentList,
    'conditionList' => $this->conditionList
]));
echo $actionsSetState->render();

// FML
$script .= '$(\'#actionsSetState\').on(\'show\', function(e) {';
$script .= 'if ($(e.target).attr(\'id\') == \'actionsSetState_wrapper\') {';
$script .= 'actionsSetState.filter();';
$script .= '}';
$script .= '});';


$actionsSetValue = new Collapse('actionsSetValue', __('AF', 'configInteractionCollapse', 'fixedValueOrAlgorithmResultAssignmentCollapse'));
$actionsSetValue->setContent($this->partial('edit/actions/set-value.phtml', [
    'af'            => $af,
    'componentList' => $this->componentList,
    'conditionList' => $this->conditionList
]));
echo $actionsSetValue->render();

// FML
$script .= '$(\'#actionsSetValue\').on(\'show\', function(e) {';
$script .= 'if ($(e.target).attr(\'id\') == \'actionsSetValue_wrapper\') {';
$script .= 'actionsSetValue.filter();';
$script .= '}';
$script .= '});';


$conditionsExpression = new Collapse('conditionsExpression', __('AF', 'configInteractionCollapse', 'composedConditionCollapse'));
$conditionsExpression->setContent($this->partial('edit/conditions/expression.phtml', ['af' => $this->af]));
echo $conditionsExpression->render();

// FML
$script .= '$(\'#conditionsExpression\').on(\'show\', function(e) {';
$script .= 'if ($(e.target).attr(\'id\') == \'conditionsExpression_wrapper\') {';
$script .= 'conditionsExpression.filter();';
$script .= '}';
$script .= '});';


$conditionsElementary = new Collapse('conditionsElementary', __('AF', 'configInteractionCollapse', 'elementaryConditionCollapse'));
$conditionsElementary->setContent($this->partial('edit/conditions/elementary.phtml', ['af' => $af, 'componentList' => $this->componentList]));
echo $conditionsElementary->render();

// FML
$script .= '$(\'#conditionsElementary\').on(\'show\', function(e) {';
$script .= 'if ($(e.target).attr(\'id\') == \'conditionsElementary_wrapper\') {';
$script .= 'conditionsElementary.filter();';
$script .= '}';
$script .= '});';
?>

<script type="text/javascript">
    <?=$script?>
</script>
