sheets:

  - foreach: granularities as granularity
    do:
      - label: "{{ translateString(granularity.label) }}"

        content:

          - type: VerticalTable
            columns:
              - foreach: getAxesForGranularity(granularity) as axis
                do:
                  - label: "{{ translateString(axis.label) }}"
              - label: "{{ displayLastColumn(granularity) }}"
              - foreach: getExtraColumnsForGranularity(granularity) as extraColumn
                do:
                  - label: " {{ extraColumn }} "

            lines:
              - foreach: getChildCellsForGranularity(cell, granularity) as childCell
                do:
                  - cells:
                    - foreach: getAxesForGranularity(granularity) as axis
                      do:
                        - "{{ displayMemberForOrgaAxis(childCell, axis) }}"
                    - "{{ displayInputStatus(granularity, childCell) }}"
                    - foreach: getExtraCells(childCell) as extraCell
                      do:
                        - " {{ extraCell }} "