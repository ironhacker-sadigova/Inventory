sheets:


  - foreach: granularities as granularity
    do:
      - label: "{{ granularity.label }}"

        content:

          - foreach: getChildCellsForGranularity(cell, granularity) as childCell
            do:
              - type: VerticalTable
                label: "{{ childCell.label }}"
                columns:
                  - foreach: granularity.axes as axis
                    do:
                      - label: "{{ axis.label }}"
                  - {{ fieldAncestor }}
                  - {{ fieldLabel }}
                  - {{ fieldType }}
                  - {{ fieldValue }}
                  - {{ fieldUncertainty }}
                lines:
                  - foreach: getInputCellFields(childCell) as field
                    do:
                    - cells:
                        - foreach: granularity.axes as axis
                          do:
                            - "{{ displayCellMemberForAxis(childCell, axis) }}"
                        - "{{ getFieldAncestors(field) }}"
                        - "{{ field.label }}"
                        - foreach: getFieldValues(field) as value
                          do:
                            - "{{ value }}"